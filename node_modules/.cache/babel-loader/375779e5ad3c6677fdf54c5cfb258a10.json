{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createStore } from 'vuex';\nexport default createStore({\n  state: {\n    // pageShip:1,\n    pagesLoaded: [],\n    ships: [],\n    stopGettingShips: false,\n    usersRegistered: [],\n    authenticated: false\n  },\n  mutations: {\n    loadShip(state, apiResponse) {\n      state.ships = [...state.ships, ...apiResponse];\n    },\n    pagesLoaded(state, page) {\n      state.pagesLoaded.push(page);\n    },\n    stopGettingShips(state) {\n      state.stopGettingShips = true;\n    },\n    loadUser(state, userData) {\n      state.usersRegistered.push(userData);\n    },\n    setAuthentication(state, status) {\n      state.authenticated = status;\n    }\n  },\n  getters: {\n    countShips(state) {\n      return state.ships.length;\n    },\n    countUsers(state) {\n      return state.usersRegistered.length;\n    }\n  },\n  actions: {\n    doSetAuthentication(context, status) {\n      context.commit(\"setAuthentication\", status);\n    },\n    loadUserToDb(context, user) {\n      context.commit(\"loadUser\", user);\n    },\n    getShipList(context, page) {\n      if (!context.state.stopGettingShips && !context.state.pagesLoaded.includes(page)) {\n        const request = fetch(`https://swapi.dev/api/starships/?page=${page}`);\n        request.then(response => {\n          if (!response.ok) {\n            throw response.status;\n          } else {\n            return response.json();\n          }\n        }).then(json => {\n          if (json.count > context.getters.countShips) {\n            context.commit(\"loadShip\", json.results);\n            context.commit(\"pagesLoaded\", page);\n          }\n          if (context.getters.countShips >= json.count) {\n            context.commit(\"stopGettingShips\");\n          }\n        }).catch(error => {\n          console.log('Ocurrió un error: ', error);\n          if (error == \"TypeError: Failed to fetch\") {\n            const request = fetch(`https://swapi.dev/api/starships/?page=${page}`);\n            request.fetch(`https://swapi.py4e.com/api/starships/?page=${page}`).then(response => {\n              if (!response.ok) {\n                throw response.status;\n              } else {\n                console.log(\"Fetch alternativo\");\n                return response.json();\n              }\n            }).then(json => {\n              if (json.count > context.getters.countShips) {\n                context.commit(\"loadShip\", json.results);\n                context.commit(\"pagesLoaded\", page);\n              }\n              if (context.getters.countShips >= json.count) {\n                context.commit(\"stopGettingShips\");\n              }\n            }).catch(error => {\n              console.log('Ocurrió un error: ', error);\n              if (error == \"TypeError: Failed to fetch\") {\n                console.log(\"Falló el fetch nuevamente\");\n              }\n            });\n          }\n        });\n      }\n    }\n  },\n  modules: {}\n});","map":{"version":3,"names":["createStore","state","pagesLoaded","ships","stopGettingShips","usersRegistered","authenticated","mutations","loadShip","apiResponse","page","push","loadUser","userData","setAuthentication","status","getters","countShips","length","countUsers","actions","doSetAuthentication","context","commit","loadUserToDb","user","getShipList","includes","request","fetch","then","response","ok","json","count","results","catch","error","console","log","modules"],"sources":["C:/Users/User01/Documents/ITAcademy/Vue/sprint8/starwars/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\n\nexport default createStore({\n  state: {\n    // pageShip:1,\n    pagesLoaded:[],\n    ships: [],\n    stopGettingShips: false,\n    usersRegistered:[],\n    authenticated:false,\n  },\n  mutations: {\n    loadShip (state, apiResponse){\n      state.ships = [...state.ships, ...apiResponse]\n    },\n    pagesLoaded (state, page){\n      state.pagesLoaded.push(page)\n    },\n    stopGettingShips (state){\n      state.stopGettingShips = true\n    },\n    loadUser (state, userData){\n      state.usersRegistered.push(userData)\n    },\n    setAuthentication(state, status){\n      state.authenticated = status\n    },\n  },\n  getters: {\n    countShips (state){\n         return state.ships.length\n     },\n    countUsers (state){\n       return state.usersRegistered.length\n    }\n  },\n  actions: {\n    doSetAuthentication(context,status){\n      context.commit(\"setAuthentication\",status)\n    },\n    loadUserToDb(context,user){\n      context.commit(\"loadUser\",user)\n    },\n    getShipList(context,page){\n      if (!context.state.stopGettingShips && !context.state.pagesLoaded.includes(page)){ \n      const request = fetch(`https://swapi.dev/api/starships/?page=${page}`);\n      request.then( response => {\n              if (!response.ok) {\n                throw response.status\n                \n              } else{\n                return response.json()\n              }\n              })\n            .then(json => {\n              if (json.count>context.getters.countShips){\n              context.commit(\"loadShip\",json.results)\n              context.commit(\"pagesLoaded\",page)\n              }\n              if (context.getters.countShips>=json.count){\n                context.commit(\"stopGettingShips\")\n              }\n            })\n            .catch((error) => {\n              console.log('Ocurrió un error: ', error)\n              if (error==\"TypeError: Failed to fetch\"){\n                const request = fetch(`https://swapi.dev/api/starships/?page=${page}`);\n                request.fetch(`https://swapi.py4e.com/api/starships/?page=${page}`)\n                .then( response => {\n                   if (!response.ok) { \n                     throw response.status\n                   } else{\n                     console.log(\"Fetch alternativo\")\n                     return response.json()\n                   }\n                   })\n                 .then(json => {\n                    if (json.count>context.getters.countShips){\n                    context.commit(\"loadShip\",json.results)\n                    context.commit(\"pagesLoaded\",page)\n                    }\n                    if (context.getters.countShips>=json.count){\n                      context.commit(\"stopGettingShips\")\n                    }\n                               })\n                 .catch((error) => {\n                   console.log('Ocurrió un error: ', error)\n                   if (error==\"TypeError: Failed to fetch\"){\n                     console.log(\"Falló el fetch nuevamente\")\n                   }\n                 });\n               }\n            });\n          }\n          },\n  },\n  modules: {\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}